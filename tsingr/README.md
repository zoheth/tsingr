# TsingR åˆ·é¢˜åº”ç”¨

ä¸€ä¸ªåŸºäº Flutter çš„è€ƒç ”é¢˜åº“åˆ·é¢˜åº”ç”¨ï¼Œå¸®åŠ©ä½ é«˜æ•ˆå‡†å¤‡è€ƒè¯•ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ“š é¢˜åº“ç®¡ç†
- **çƒ­åº¦æ’åº**ï¼šè‡ªåŠ¨æŒ‰é¢˜ç›®è¢«è€ƒæŸ¥æ¬¡æ•°æ’åºï¼Œä¼˜å…ˆæ˜¾ç¤ºé«˜é¢‘é¢˜
- **æ™ºèƒ½ç­›é€‰**ï¼š
  - æŒ‰æ ‡ç­¾ç­›é€‰ï¼ˆç®€ç­”ã€è®ºè¿°ã€åè§£ç­‰ï¼‰
  - æŒ‰çƒ­åº¦ç­›é€‰ï¼ˆâ‰¥5æ ¡ã€â‰¥10æ ¡ã€â‰¥15æ ¡ï¼‰
  - å…³é”®è¯æœç´¢
- **åˆ†ç±»æµè§ˆ**ï¼šä¸€çº§/äºŒçº§æ ‡é¢˜åˆ†ç±»æ˜¾ç¤º

### ğŸ“ åˆ·é¢˜åŠŸèƒ½
- **å­¦ä¹ è®°å½•**ï¼šè®°å½•æ¯é“é¢˜çš„å­¦ä¹ æ¬¡æ•°å’Œæ—¶é—´
- **é‡å¤åˆ·é¢˜**ï¼šæ”¯æŒåŒä¸€é¢˜ç›®å¤šæ¬¡å­¦ä¹ 
- **æ”¶è—åŠŸèƒ½**ï¼šæ”¶è—é‡è¦é¢˜ç›®æ–¹ä¾¿å¤ä¹ 
- **è¯¦ç»†ä¿¡æ¯**ï¼š
  - é¢˜ç›®å®Œæ•´å†…å®¹
  - å†å¹´è€ƒè¯•è®°å½•ï¼ˆå­¦æ ¡ã€å¹´ä»½ã€ä¸“ä¸šä»£ç ï¼‰
  - é¢˜ç›®æ ‡ç­¾å’Œåˆ†ç±»
  - å­¦ä¹ ç»Ÿè®¡

### ğŸ“Š ç»Ÿè®¡åˆ†æ
- **å­¦ä¹ è¿›åº¦**ï¼šæ•´ä½“å­¦ä¹ è¿›åº¦å¯è§†åŒ–
- **ç»Ÿè®¡æ•°æ®**ï¼š
  - æ€»é¢˜æ•°
  - å·²å­¦ä¹ é¢˜æ•°
  - æ€»åˆ·é¢˜æ¬¡æ•°
  - æ”¶è—æ•°é‡
- **å­¦ä¹ å†å²**ï¼šæŸ¥çœ‹æœ€è¿‘å­¦ä¹ çš„é¢˜ç›®
- **æ”¶è—åˆ—è¡¨**ï¼šå¿«é€Ÿè®¿é—®æ”¶è—çš„é¢˜ç›®

### ğŸ’¾ æ•°æ®æŒä¹…åŒ–
- ä½¿ç”¨ SharedPreferences æœ¬åœ°å­˜å‚¨å­¦ä¹ è¿›åº¦
- æ•°æ®è‡ªåŠ¨ä¿å­˜ï¼Œä¸ä¼šä¸¢å¤±

## è¿è¡Œåº”ç”¨

1. ç¡®ä¿å·²å®‰è£… Flutter SDK
2. å®‰è£…ä¾èµ–ï¼š
   ```bash
   cd tsingr
   flutter pub get
   ```
3. è¿è¡Œåº”ç”¨ï¼š
   ```bash
   flutter run
   ```

## ä½¿ç”¨æŒ‡å—

### é¦–é¡µï¼ˆé¢˜åº“ï¼‰
1. æµè§ˆé¢˜ç›®åˆ—è¡¨ï¼ŒæŒ‰çƒ­åº¦è‡ªåŠ¨æ’åº
2. ä½¿ç”¨é¡¶éƒ¨æœç´¢æ¡†æœç´¢é¢˜ç›®
3. ç‚¹å‡»å³ä¸Šè§’ç­›é€‰æŒ‰é’®è¿›è¡Œç­›é€‰
4. ç‚¹å‡»é¢˜ç›®å¡ç‰‡æŸ¥çœ‹è¯¦æƒ…
5. ç‚¹å‡»æ˜Ÿæ ‡æ”¶è—/å–æ¶ˆæ”¶è—

### é¢˜ç›®è¯¦æƒ…é¡µ
1. æŸ¥çœ‹é¢˜ç›®å®Œæ•´å†…å®¹å’Œåˆ†ç±»
2. æŸ¥çœ‹æ‰€æœ‰è€ƒè¯•è®°å½•ï¼ˆå­¦æ ¡ã€å¹´ä»½ã€æ ‡ç­¾ï¼‰
3. æŸ¥çœ‹å­¦ä¹ ç»Ÿè®¡
4. ç‚¹å‡»åº•éƒ¨"æ ‡è®°ä¸ºå·²å­¦ä¹ "æŒ‰é’®è®°å½•å­¦ä¹ 

### ç»Ÿè®¡é¡µ
1. æŸ¥çœ‹æ•´ä½“å­¦ä¹ è¿›åº¦å’Œç»Ÿè®¡æ•°æ®
2. æŸ¥çœ‹æ”¶è—çš„é¢˜ç›®
3. æŸ¥çœ‹æœ€è¿‘å­¦ä¹ çš„é¢˜ç›®
4. ç‚¹å‡»ä»»æ„é¢˜ç›®å¡ç‰‡è·³è½¬åˆ°è¯¦æƒ…é¡µ

## é¡¹ç›®ç»“æ„

```
lib/
â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ question.dart    # é¢˜ç›®å’Œè€ƒè¯•è®°å½•æ¨¡å‹
â”‚   â””â”€â”€ study_record.dart # å­¦ä¹ è®°å½•æ¨¡å‹
â”œâ”€â”€ services/            # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ data_service.dart    # CSVæ•°æ®åŠ è½½
â”‚   â””â”€â”€ storage_service.dart # æœ¬åœ°å­˜å‚¨
â”œâ”€â”€ providers/           # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ study_provider.dart  # å…¨å±€çŠ¶æ€ç®¡ç†
â”œâ”€â”€ pages/               # é¡µé¢
â”‚   â”œâ”€â”€ home_page.dart           # ä¸»é¡µï¼ˆé¢˜ç›®åˆ—è¡¨ï¼‰
â”‚   â”œâ”€â”€ question_detail_page.dart # é¢˜ç›®è¯¦æƒ…
â”‚   â””â”€â”€ statistics_page.dart     # ç»Ÿè®¡é¡µé¢
â””â”€â”€ main.dart            # åº”ç”¨å…¥å£
```

## æ•°æ®è¯´æ˜

åº”ç”¨ä½¿ç”¨ä¸¤ä¸ª CSV æ–‡ä»¶ï¼ˆä½äº `assets/` ç›®å½•ï¼‰ï¼š

1. **questions.csv**ï¼šé¢˜ç›®ä¸»è¡¨ï¼ŒåŒ…å«6637é“é¢˜ç›®
2. **appearances.csv**ï¼šè€ƒè¯•è®°å½•è¡¨ï¼ŒåŒ…å«10788æ¡è®°å½•

æ•°æ®ç”± Python è„šæœ¬å¤„ç†ç”Ÿæˆã€‚æ›´æ–°æ•°æ®ï¼š
```bash
python scripts/process_text.py
cp data/questions.csv data/appearances.csv tsingr/assets/
```

## æŠ€æœ¯æ ˆ

- **Flutter**ï¼šè·¨å¹³å° UI æ¡†æ¶
- **Provider**ï¼šçŠ¶æ€ç®¡ç†
- **CSV**ï¼šCSV æ–‡ä»¶è§£æ
- **SharedPreferences**ï¼šæœ¬åœ°æ•°æ®æŒä¹…åŒ–

## æ‰“åŒ…å®‰å“APK

### æ–¹æ³•ä¸€ï¼šå¿«é€Ÿæ‰“åŒ…ï¼ˆæµ‹è¯•ç”¨ï¼‰

ç›´æ¥æ„å»ºè°ƒè¯•ç‰ˆæœ¬APKï¼š

```bash
cd tsingr
flutter build apk
```

APK æ–‡ä»¶ä½ç½®ï¼š`build/app/outputs/flutter-apk/app-release.apk`

### æ–¹æ³•äºŒï¼šæ‰“åŒ…å‘å¸ƒç‰ˆæœ¬ï¼ˆæ¨èï¼‰

#### 1. ä¿®æ”¹åº”ç”¨ä¿¡æ¯

ç¼–è¾‘ `android/app/build.gradle.kts`ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š

```kotlin
defaultConfig {
    applicationId = "com.tsingr.study"  // ä¿®æ”¹ä¸ºä½ çš„åº”ç”¨ID
    minSdk = 21  // æœ€ä½æ”¯æŒ Android 5.0
    targetSdk = 34
    versionCode = 1  // ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡å‘å¸ƒé€’å¢
    versionName = "1.0.0"  // ç‰ˆæœ¬åç§°
}
```

#### 2. ä¿®æ”¹åº”ç”¨åç§°å’Œå›¾æ ‡

**ä¿®æ”¹åº”ç”¨åç§°ï¼š**

ç¼–è¾‘ `android/app/src/main/AndroidManifest.xml`ï¼š
```xml
<application
    android:label="TsingRåˆ·é¢˜"  <!-- ä¿®æ”¹è¿™é‡Œ -->
    ...>
```

**ä¿®æ”¹åº”ç”¨å›¾æ ‡ï¼š**

å°†å›¾æ ‡æ–‡ä»¶æ”¾åˆ°ä»¥ä¸‹ç›®å½•ï¼ˆæ›¿æ¢é»˜è®¤å›¾æ ‡ï¼‰ï¼š
- `android/app/src/main/res/mipmap-hdpi/ic_launcher.png`
- `android/app/src/main/res/mipmap-mdpi/ic_launcher.png`
- `android/app/src/main/res/mipmap-xhdpi/ic_launcher.png`
- `android/app/src/main/res/mipmap-xxhdpi/ic_launcher.png`
- `android/app/src/main/res/mipmap-xxxhdpi/ic_launcher.png`

æˆ–ä½¿ç”¨å·¥å…·ç”Ÿæˆï¼š[https://icon.kitchen/](https://icon.kitchen/)

#### 3. ç”Ÿæˆç­¾åå¯†é’¥ï¼ˆå¯é€‰ï¼Œç”¨äºæ­£å¼å‘å¸ƒï¼‰

```bash
# ç”Ÿæˆå¯†é’¥åº“
keytool -genkey -v -keystore ~/tsingr-key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias tsingr

# æŒ‰æç¤ºè¾“å…¥å¯†ç å’Œä¿¡æ¯
```

åˆ›å»º `android/key.properties` æ–‡ä»¶ï¼š
```properties
storePassword=ä½ çš„å¯†é’¥åº“å¯†ç 
keyPassword=ä½ çš„å¯†é’¥å¯†ç 
keyAlias=tsingr
storeFile=ä½ çš„å¯†é’¥åº“è·¯å¾„ï¼ˆå¦‚ï¼šC:/Users/YourName/tsingr-key.jksï¼‰
```

ä¿®æ”¹ `android/app/build.gradle.kts`ï¼š

```kotlin
// åœ¨ android å—ä¹‹å‰æ·»åŠ 
def keystoreProperties = new Properties()
def keystorePropertiesFile = rootProject.file('key.properties')
if (keystorePropertiesFile.exists()) {
    keystoreProperties.load(new FileInputStream(keystorePropertiesFile))
}

android {
    // ... å…¶ä»–é…ç½®

    signingConfigs {
        release {
            keyAlias keystoreProperties['keyAlias']
            keyPassword keystoreProperties['keyPassword']
            storeFile keystoreProperties['storeFile'] ? file(keystoreProperties['storeFile']) : null
            storePassword keystoreProperties['storePassword']
        }
    }

    buildTypes {
        release {
            signingConfig signingConfigs.release  // ä½¿ç”¨å‘å¸ƒç­¾å
            minifyEnabled true  // å¯ç”¨ä»£ç æ··æ·†
            shrinkResources true  // å¯ç”¨èµ„æºå‹ç¼©
        }
    }
}
```

#### 4. æ„å»ºå‘å¸ƒç‰ˆAPK

```bash
cd tsingr

# æ„å»ºå‘å¸ƒç‰ˆ APK
flutter build apk --release

# æˆ–æ„å»ºåˆ†æ¶æ„APKï¼ˆæ–‡ä»¶æ›´å°ï¼‰
flutter build apk --split-per-abi
```

è¾“å‡ºæ–‡ä»¶ä½ç½®ï¼š
- é€šç”¨ç‰ˆï¼š`build/app/outputs/flutter-apk/app-release.apk`
- åˆ†æ¶æ„ç‰ˆï¼š
  - `build/app/outputs/flutter-apk/app-armeabi-v7a-release.apk` (32ä½ARM)
  - `build/app/outputs/flutter-apk/app-arm64-v8a-release.apk` (64ä½ARMï¼Œæ¨è)
  - `build/app/outputs/flutter-apk/app-x86_64-release.apk` (x86æ¨¡æ‹Ÿå™¨)

#### 5. æ„å»º App Bundleï¼ˆGoogle Play æ¨èï¼‰

```bash
flutter build appbundle --release
```

è¾“å‡ºï¼š`build/app/outputs/bundle/release/app-release.aab`

### å¸¸è§é—®é¢˜

**1. æ„å»ºå¤±è´¥ï¼Ÿ**
```bash
# æ¸…ç†æ„å»ºç¼“å­˜
flutter clean
flutter pub get
flutter build apk
```

**2. APK è¿‡å¤§ï¼Ÿ**
- ä½¿ç”¨ `--split-per-abi` åˆ†æ¶æ„æ„å»º
- å¯ç”¨ä»£ç æ··æ·†å’Œèµ„æºå‹ç¼©ï¼ˆè§ä¸Šæ–‡ï¼‰

**3. å®‰è£…æ—¶æç¤º"æœªçŸ¥æ¥æº"ï¼Ÿ**
- åœ¨æ‰‹æœºè®¾ç½®ä¸­å…è®¸å®‰è£…æœªçŸ¥æ¥æºåº”ç”¨

**4. CSV æ•°æ®åŠ è½½å¤±è´¥ï¼Ÿ**
- ç¡®ä¿ `assets/` ç›®å½•ä¸‹æœ‰ `questions.csv` å’Œ `appearances.csv`
- æ£€æŸ¥ `pubspec.yaml` ä¸­çš„ assets é…ç½®

### å¿«é€Ÿå‘½ä»¤

```bash
# å¼€å‘æµ‹è¯•
flutter run

# æ‰“åŒ…è°ƒè¯•ç‰ˆ
flutter build apk --debug

# æ‰“åŒ…å‘å¸ƒç‰ˆï¼ˆæ¨èï¼‰
flutter build apk --release --split-per-abi

# æŸ¥çœ‹APKå¤§å°åˆ†æ
flutter build apk --analyze-size
```
